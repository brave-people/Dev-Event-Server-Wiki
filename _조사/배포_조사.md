# í™˜ê²½
- ë°°í¬ (ë¹„ìš© ë¶„ì„ì¤‘)
    - í™˜ê²½: AWS vs NCP
    - DB
        - AWS RDB 
        - [Amazon RDS ìš”ê¸ˆ](https://aws.amazon.com/ko/rds/pricing/)
    - ìºì‹œ
        - [Amazon ElastiCache](https://docs.aws.amazon.com/ko_kr/AmazonElastiCache/latest/mem-ug/SelectEngine.html)
            - cache.t3.small(0.049 USD)ê¸°ì¤€ í•œë‹¬ 41817.6ì› (ì°¸ê³ . [Amazon ElastiCache ìš”ê¸ˆ](https://aws.amazon.com/ko/elasticache/pricing/))
    - ë©€í‹°ë¯¸ë””ì–´ íŒŒì¼
        - Cloud Front
    - ì¡°í•©
        - Local + Git action
        - Jenkins + EC2
        - Docker(ECR)
    - íƒìƒ‰
        - í•´ë¡œì¿ : [telbby/ telbby-backend](https://github.com/telbby/telbby-backend)
    - ì •ì  í˜ì´ì§€
        - netlify: [ì–´ì¸ ë°ë¸Œ ë¸”ë¡œê·¸](https://awesome-devblog.netlify.app/)
        - [vercel](https://vercel.com/pricing)
- ëª¨ë‹ˆí„°ë§
    - ë¹„ìš©: AWS ìŠ¬ë™ hook
- ê¸°íƒ€ ê³ ë ¤ì‚¬í•­
    - ëª¨ë°”ì¼ì„ ìœ„í•œ API
    - í˜¸ì¶œíšŸìˆ˜ ì œí•œ

<hr />
<br />

# ì‹¤ìŠµ
> CIì˜ ê²½ìš° Github Actionsë¼ëŠ” ëª…í™•í•œ ë¬´ë£Œ íˆ´ ì¡´ì¬
>
> CDì—ì„œ í›„ë³´ë“¤ì„ ì‚°ì •í•˜ì—¬ ì¡°í•©



**Github Actions with**

- [Heroku](#1-heroku-)
- [CodeDeploy /w EC2](#2-codedeploy-w-ec2-)



<br />

--------------------------------------------------------------------------

## 1. Heroku [ğŸ‘†](#ì‹¤ìŠµ)

| ë¹„ìš© | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ë¹„ê³                                                          |
| ---- | ----------- | ------------------------------------------------------------ |
| ë¬´ë£Œ | O (ì™„ë£Œ)    | 30ë¶„ê°„ íŠ¸ë˜í”½ ì—†ëŠ” ê²½ìš° ì„œë²„ ë‹¤ìš´ ì´ìŠˆ í•´ê²°<br /><a href="https://nhj12311.tistory.com/283" target="_blank">p.s. í—¤ë¡œì¿  ì ë“¤ì§€ ì•Šê²Œ</a> |



\< ì‚¬ìš©ë²• >

1. ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ ì¤€ë¹„

   âš ï¸ ì£¼ì˜ : ë¡œì»¬ì—ì„œ ë¹Œë“œ(`./gradlew build`)ë¥¼ í•˜ê³  git pushë¥¼ í•˜ëŠ” ê²ƒì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±

   <br />

2. í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê²½ë¡œì—ì„œ

   - Procfile íŒŒì¼ ë§Œë“¤ê¸° (í™•ì¥ì ì—†ìŒ)

     ```
     web: java -Dserver.port=$PORT $JAVA_OPTS -jar [ë¹Œë“œëª…].jar
     ```

   - system.properties íŒŒì¼ ë§Œë“¤ê¸° (í•„ìˆ˜ëŠ” ì•„ë‹˜)

     <a href="https://devcenter.heroku.com/articles/java-support" target="_blank">herokuê°€ ìë°”ë¥¼ ì§€ì›í•˜ëŠ” ë°©ì‹</a>

     ```
     java.runtime.version=11
     ```

   - gradlewë¥¼ ì‚¬ìš©í•œë‹¤ë©´, /gradle/wrapper í´ë”ëŠ” gitignoreë¡œ ë¹¼ë©´ ì•ˆë¨

   <a href="https://devcenter.heroku.com/articles/deploying-gradle-apps-on-heroku" target="_blank">=> Heroku ê³µì‹ í™ˆí˜ì´ì§€</a>

   <br />

3. heroku ì•± ë§Œë“¤ê¸° (íšŒì›ê°€ì… í•„ìš”)

   <a href="https://dashboard.heroku.com/apps" target="_blank">heroku App í™”ë©´</a>ì—ì„œ newë¡œ ìƒì„±

   <br />

4. ë ˆí¬ì§€í† ë¦¬ Actionsíƒ­ > 'set up a workflow yourself'ë¥¼ ì„ íƒ

   (ì´ë¯¸ ë§Œë“ ì  ìˆë‹¤ë©´ New workflow)

   ![image](https://user-images.githubusercontent.com/42775225/143018586-abc0994f-55bc-44cf-96e3-811105608a3d.png)

   ê·¸ëŸ¬ë©´ ë£¨íŠ¸ì— .github/workflows ë¼ëŠ” í´ë”ì˜ ymlíŒŒì¼ ìˆ˜ì •

   ```yaml
   name: [ì›í•˜ëŠ” ì´ë¦„]
   
   on:
     push:
       branches: [ main ]
   
   jobs:
     build:
       runs-on: ubuntu-latest    # ëŒë¦´ OS
       
       steps:
         - uses: actions/checkout@v2
         
   #      - name: Build project    # ë¡œì»¬ì—ì„œ buildí•´ì„œ í™•ì¸í•˜ê³  ë°°í¬í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ì´ê±´ êµ³ì´ í•„ìš”ëŠ” ì—†ìŒ 
   #        run: ./gradlew build
     
         - name: Deploy to Heroku
           uses: AkhileshNS/heroku-deploy@v3.12.12
           with:
             heroku_api_key: ${{ secrets.heroku_api_key }}
             heroku_email: ${{ secrets.heroku_email }}
             heroku_app_name: ${{ secrets.heroku_app_name }}
   ```

   - heroku_api_key
   - heroku_email
   - heroku_app_name

   ê°’ì˜ ê²½ìš°, Settingsíƒ­ > Secretsì—ì„œ ê°’ì„ ìˆ¨ê²¨ì„œ ë³€ìˆ˜ë¡œ ì‚¬ìš©

   

cf) <a href="https://developer.okta.com/docs/guides/deploy-your-app/java/#heroku" target="_blank">í—¤ë¡œì¿  ë°°í¬</a>

<br /><br /><br />



--------------------------------------------------------------------------

## 2. CodeDeploy /w EC2 [ğŸ‘†](#ì‹¤ìŠµ)

| ë¹„ìš© (1Month)                                         | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ë¹„ê³                                                          |
| ----------------------------------------------------- | ----------- | ------------------------------------------------------------ |
| CodeDeployë¹„ìš©(0ì›) <br />+ <br />EC2ë¹„ìš©(ì•½ 11232ì›) | O (ì™„ë£Œ)    | CodeDeployë¡œ AWS EC2ì— ë°°í¬í•˜ë©´ ë¬´ë£Œ <a href="https://aws.amazon.com/ko/codedeploy/pricing/?nc=sn&loc=3" target="_blank">(ì°¸ê³  ë§í¬)</a> |



**<ì‚¬ì „ ì¤€ë¹„>**

EC2 ë°°í¬ í…ŒìŠ¤íŠ¸ ì„ í–‰.

cf) ìš”ê¸ˆì€

- ì˜¨ë””ë§¨ë“œ

- ì•„ì‹œì•„(ì„œìš¸)
- Linux

ì„ ê¸°ì¤€ìœ¼ë¡œ ì•„ë˜í‘œ.

![image](https://user-images.githubusercontent.com/42775225/144217850-b1aeac3d-232c-4cfe-b94b-f1bc2a44a1da.png)

<a href="https://aws.amazon.com/ko/ec2/pricing/on-demand/" target="_blank">AWS ê³µì‹ ìš”ê¸ˆ í˜ì´ì§€ ì°¸ì¡°</a>



t3.microë¶€í„° í…ŒìŠ¤íŠ¸ ì˜ˆì •.

(t3.microëŠ” í•œ ë‹¬ì— 11232ì› ì •ë„ (í™˜ìœ¨ : 1200ì› ê¸°ì¤€)ê°€ ì˜ˆìƒ)

EC2ì—ëŠ” jar ë°°í¬ íŒŒì¼ê³¼ MySQL DBì„œë²„ë§Œ ë‘ëŠ” ì „ëµ.



<br />

#### 1) ë¡œì»¬

1. ë¹Œë“œ í›„ jar ì¤€ë¹„

   ```shell
   ./gradlew build
   ```

   <br />

2. AWS EC2ë¡œ ìˆ˜ë™ ì „ì†¡ (CodeDeployë¡œ ìë™í™” ì˜ˆì •)

   ```shell
   scp -i [í‚¤ì´ë¦„].pem dev-event-server-0.0.1-SNAPSHOT.jar ubuntu@[ì„œë²„IP]:~/
   ```



<br />

#### 2) ì„œë²„

1. jvm ì„¤ì¹˜ <a href="https://davelogs.tistory.com/71" target="_blank">(ì°¸ì¡° ë§í¬)</a>

   ```\
   $ sudo apt-get update
   $ sudo apt-get upgrade
   
   # JAVA11 ì„¤ì¹˜
   $ sudo apt-get install openjdk-11-jdk
   ```

   <br />

2. mysql ì„¤ì¹˜ <a href="https://velog.io/@seungsang00/Ubuntu-%EC%9A%B0%EB%B6%84%ED%88%AC%EC%97%90-MySQL-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0" target="_blank">(ì°¸ì¡° ë§í¬)</a>

```shell
sudo apt-get update # ìš°ë¶„íˆ¬ ì„œë²„ ì—…ë°ì´íŠ¸
sudo apt-get install mysql-server # mysql-server ì„¤ì¹˜
sudo ufw allow mysql # ì™¸ë¶€ ì ‘ì† ê¸°ëŠ¥ ì„¤ì • (í¬íŠ¸ 3306 ì˜¤í”ˆ)
sudo systemctl start mysql # MySQL ì‹¤í–‰
sudo systemctl enable mysql # Ubuntu ì„œë²„ ì¬ì‹œì‘ì‹œ MySQL ìë™ ì¬ì‹œì‘
sudo /usr/bin/mysql -u root -p # MySQL ì ‘ì†

CREATE DATABASE dev_event default CHARACTER SET UTF8; # DBìƒì„±
```

- í´ë¼ìš°ë“œ ë°©í™”ë²½ ì˜¤í”ˆ: [ì°¸ê³ ](https://technfin.tistory.com/entry/%EC%98%A4%EB%9D%BC%ED%81%B4-%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%ED%8F%AC%ED%8A%B8-%EA%B0%9C%EB%B0%A9%ED%95%98%EA%B8%B0?category=867921)

cf) ì°¸ê³ ë¡œ í˜„ì¬ port 9000ìœ¼ë¡œ í”½ìŠ¤ í•´ë‘ì—ˆìœ¼ë¯€ë¡œ, EC2ì—ì„œ ë°©í™”ë²½(ì¸ë°”ìš´ë“œ ê·œì¹™) 9000 ì˜¤í”ˆ í•„ìš”.


<br />

#### 3) ëª¨ë‹ˆí„°ë§

http://[ì„œë²„IP]:9000/admin/v1/events/2021/7 ë¡œ í•´ë³´ë©´ ê¸°ë³¸ì ì¸ API ì‘ë‹µ ê°€ëŠ¥í•œ ê²ƒ í™•ì¸ ì™„ë£Œ.

ëª¨ë‹ˆí„°ë§ ì„¤ì •ì„ ì¤€ë¹„.









**\< CodeDeploy ì‚¬ìš©ë²• >**

<a href="https://isntyet.github.io/deploy/github-action%EA%B3%BC-aws-code-deploy%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-spring-boot-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0(1)/" target="_blank">JaeYoung ë‹˜ ë¸”ë¡œê·¸</a> ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.



1. EC2ì— rubyì„¤ì¹˜ í›„ code-deploy agentë¥¼ ì„¤ì¹˜

   ```shell
   sudo apt-get update
   sudo apt-get install ruby
   sudo apt-get install wget
   cd /home/ubuntu
   
   wget https://`bucket-name`.s3.`region-identifier`.amazonaws.com/latest/install
   chmod +x ./install
   sudo ./install auto
   ```

   bucket-nameê³¼ region-identifierì€ 

   <a href="https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/resource-kit.html#resource-kit-bucket-names" target="_blank">AWS ê³µì‹ ë¬¸ì„œ</a>ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì •í•˜ë˜ ì €ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

   ```shell
   wget https://aws-codedeploy-ap-northeast-2.s3.ap-northeast-2.amazonaws.com/latest/install
   ```

   (ì°¸ê³ ë¡œ, í˜„ì¬ EC2ì—ëŠ” jvmê³¼ mysqlì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì„œ ìë°” ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ê°€ëŠ¥í•œ ìƒíƒœì—ì„œ ì‹œì‘í•˜ì˜€ìŠµë‹ˆë‹¤.)



2. AWS ì„¸íŒ… (ìœ„ì˜ ë¸”ë¡œê·¸ë¥¼ ì°¸ê³ í•˜ì—¬ ì„¸íŒ…)
   - EC2 IAM ì„¤ì •
   - CodeDeploy ì–´í”Œë¦¬ì¼€ì´ì…˜ ìƒì„± ë° IAM ì„¤ì •
   - S3 ìƒì„±
   - ì‚¬ìš©ì ìƒì„± (accessKey, secretKey í•„ìš”) 



3. EC2 ë°°í¬ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

   í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê²½ë¡œì—

   - appspec.yml

     ```yaml
     version: 0.0
     os: linux
     
     files:
       - source: /
         destination: /home/ubuntu/sangjin-deploy
     permissions:
       - object: /home/ubuntu/sangjin-deploy/
         owner: ubuntu
         group: ubuntu
     hooks:
       AfterInstall:
         - location: scripts/deploy.sh
           timeout: 60
           runas: ubuntu
     
     ```

   - deploy.sh

     ```shell
     #!/usr/bin/env bash
     
     REPOSITORY=/home/ubuntu/sangjin-deploy
     cd $REPOSITORY
     
     APP_NAME=actions
     JAR_NAME=$(ls $REPOSITORY/build/libs/ | grep 'SNAPSHOT.jar' | tail -n 1)
     JAR_PATH=$REPOSITORY/build/libs/$JAR_NAME
     
     CURRENT_PID=$(pgrep -f $APP_NAME)
     
     if [ -z $CURRENT_PID ]
     then
       echo "> ì¢…ë£Œí• ê²ƒ ì—†ìŒ."
     else
       echo "> kill -9 $CURRENT_PID"
       kill -15 $CURRENT_PID
       sleep 5
     fi
     
     echo "> $JAR_PATH ë°°í¬"
     nohup java -jar $JAR_PATH > /dev/null 2> /dev/null < /dev/null &
     
     
     ```



### STEP 4. .github/workflowsì—ì„œ yml ìƒì„±

```yaml
# This is a basic workflow to help you get started with Actions

name: github actions + heroku

on:
  push:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

env:
  PROJECT_NAME: CDapp

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2

      - name: Make zip file
        run: zip -qq -r ./$GITHUB_SHA.zip .   # GITHUB_SHAëŠ” ì˜ˆì•½ë³€ìˆ˜ë¡œ, ì»¤ë°‹ í•´ì‹œê°’
        shell: bash

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id: ${{ secrets.accessKey }}
          aws-secret-access-key: ${{ secrets.secretKey }}
          aws-region: ${{ secrets.region }}

      - name: Upload to S3
        run: aws s3 cp --region ap-northeast-2 ./$GITHUB_SHA.zip s3://sangjin-deploy/$PROJECT_NAME/$GITHUB_SHA.zip

      - name: Code Deploy
        run: aws deploy create-deployment --application-name CDapp --deployment-config-name CodeDeployDefault.OneAtATime --deployment-group-name CDapp --s3-location bucket=sangjin-deploy,bundleType=zip,key=$PROJECT_NAME/$GITHUB_SHA.zip
```

<hr />
<br />

### 5. ì„±ê³µ â­ï¸
![image](https://user-images.githubusercontent.com/42775225/144769049-09ba47a0-abf0-4e57-b477-f69ec0654b22.png)
   

<hr />

## 3. GCP ì‚¬ìš©

<br />

### 3-1. GCP Compute Engine + MySQL
```
STEP 1. ec2-micro ì¸ìŠ¤í„´ìŠ¤ì— MySQL ì„¤ì¹˜
        ì„¤ì¹˜ ì»¤ë©˜ë“œ ê¸°ë¡

STEP 2. ec2-micro ì¸ìŠ¤í„´ìŠ¤ ë¹„ìš© ì •ì±… ê¸°ë¡
```

<br />

> STEP 1.

1. ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±

   ***mysql.sh***

   ```shell
   sudo apt-get -y update # ìš°ë¶„íˆ¬ ì„œë²„ ì—…ë°ì´íŠ¸
   sudo apt-get -y install mysql-server # mysql-server ì„¤ì¹˜ (í˜¹ì€ mariadb-server)
   sudo ufw allow mysql # ì™¸ë¶€ ì ‘ì† ê¸°ëŠ¥ ì„¤ì • (í¬íŠ¸ 3306 ì˜¤í”ˆ)
   sudo systemctl start mysql # MySQL ì‹¤í–‰
   sudo systemctl enable mysql # Ubuntu ì„œë²„ ì¬ì‹œì‘ì‹œ MySQL ìë™ ì¬ì‹œì‘
   
   
   query="CREATE DATABASE [DBëª…] default CHARACTER SET UTF8; # DBìƒì„±
   
   CREATE USER '[ì‚¬ìš©ìëª…]'@'[Springì„œë²„ IP]' IDENTIFIED BY '[ë¹„ë°€ë²ˆí˜¸]'; # ì‚¬ìš©ì ìƒì„±
   FLUSH PRIVILEGES;
   
   GRANT ALL PRIVILEGES ON [DBëª…].* TO '[ì‚¬ìš©ìëª…]'@'[Springì„œë²„ IP]';
   FLUSH PRIVILEGES;
   SHOW GRANTS FOR'[ì‚¬ìš©ìëª…]'@'[Springì„œë²„ IP]';"
   
   sudo /usr/bin/mysql -u root -D mysql -e "${query}"  # DB ì¿¼ë¦¬ ì‹¤í–‰
   ```

2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

   ```shell
   ./mysql.sh
   ```

<br />



> STEP 2.

<a href="https://cloud.google.com/free/docs/gcp-free-tier?hl=ko&_ga=2.142668413.-979674017.1638945935#free-tier-usage-limits" target="_blank">GCP ë¬´ë£Œ í”„ë¡œê·¸ë¨</a> ì„ ì°¸ê³ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì•ˆë‚´ê¸€ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



![image](https://user-images.githubusercontent.com/42775225/145178387-676668c5-7c7d-409e-bca5-6ff699d670d5.png)

- íŠ¹ì • ë¦¬ì „ (ì˜¤ë¦¬ê±´: `us-west1`, ì•„ì´ì˜¤ì™€: `us-central1`, ì‚¬ìš°ìŠ¤ìºë¡¤ë¼ì´ë‚˜: `us-east1`)
- ìŠ¤í† ë¦¬ì§€ 30GB

ê¹Œì§€ëŠ” ì›” 720ì‹œê°„ê¹Œì§€ ë¬´ë£Œë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/42775225/145178421-0dbd7bb6-57e3-411c-9e4f-148548641e68.png)



(ì›”ë³„ ì˜ˆìƒ ê°€ê²©ì€ 720ì‹œê°„ ì´ˆê³¼ í›„ì˜ ê°€ê²©ì´ì§€ ì•Šì„ê¹Œ ìƒê°ë©ë‹ˆë‹¤.)



<br />
<br />

### 3-2. í—¤ë¡œì¿  ì—°ë™ í…ŒìŠ¤íŠ¸
```text
STEP 1.  GCP ì¸ìŠ¤í„´ìŠ¤ì— ì„¤ì¹˜í•œ MySQLì— í—¤ë¡œì¿  ì—°ë™
          MySQL ì •ë³´ëŠ”application-real.yml ì„¤ì •ì •ë³´ ì¶”ê°€

STEP 2. DEV GROUP real dataë¡œ insert

STEP 3. API ëª‡ë²ˆ í˜¸ì¶œí•´ë³´ê³  í‰ê·  ì‘ë‹µ ms ê¸°ë¡
```

<br />

### STEP 1. GCP MySQL ì„œë²„ IP í™•ì¸ í›„ í”„ë¡œì íŠ¸ ì„¤ì • ê°’ ë³€ê²½

- MySQL IP : xx.xxx.xx.xxx
- appliction-real.yml
```yaml
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://xx.xxx.xx.xxx:3306/dev_event?characterEncoding=UTF-8&serverTimezone=UTC
    username: [ì‚¬ìš©ìëª…]
    password: [ë¹„ë°€ë²ˆí˜¸]
```
- â›± ì£¼ì˜í•  ì 
  - mysql ì„œë²„ì˜ ì‚¬ìš©ìë¥¼ ë§Œë“¤ë•Œ `ìŠ¤í”„ë§ ì„œë²„ ip` ë§Œ í—ˆìš©í•´ì„œ ë§Œë“¤ê²ƒ
  - dbì„œë²„ ipì˜¤í”ˆì€ `ìŠ¤í”„ë§ ì„œë²„ ip` ë§Œ í—ˆìš©í•  ê²ƒ

<hr />
<br />


### STEP 2. MySQL ì„œë²„ ì˜¤í”ˆ

```shell
vi /etc/mysql/mariadb.conf.d/50-server.cnf
```
***50-server.cnf***

<br />

```
bind-address = [ìŠ¤í”„ë§ ì„œë²„ ip]
```

<br />

```shell
service mysql restart
netstat -lntp  # 3306ë²ˆ í¬íŠ¸ ì—´ë¦° ip í™•ì¸  
```
- cf) `mysql -h '[MySQLì„œë²„ IP]' -u [ì‚¬ìš©ìëª…] -p` ë¡œ í…ŒìŠ¤íŠ¸ í™•ì¸
   
<br />
<br />
<br />

### STEP 3. ì´ë ‡ê²Œ í•˜ë©´ ë°°í¬ëŠ” ì™„ë£Œ~!

![image](https://user-images.githubusercontent.com/42775225/145210435-d7a2bfec-24b0-4dd5-8810-8cb04653e2fc.png)

<br />

cf) heroku ì°¸ê³ 

```shell
$ heroku login

$ heroku git:remote -a sangjin-test

$ git add .
$ git commit -am "make it better"
$ git push heroku master
```

<br />
<br />
<br />
<br />


<br />

> STEP 3.

| ID   | í˜¸ì¶œ url                       | ì†Œìš” ì‹œê°„ |
| ---- | ------------------------------ | --------- |
| 1    | [ì¸ì¦] ê´€ë¦¬ì ê³„ì • ë¡œê·¸ì¸      | ì•½ 700ms  |
| 2    | [ì¸ì¦] ê´€ë¦¬ì ê³„ì • ê°€ì…        | ì•½ 1500ms |
| 3    | [ROLE] ìƒì„±                    | ì•½ 300ms  |
| 4    | [ROLE] ì „ì²´ ì¡°íšŒ               | ì•½ 600ms  |
| 5    | [ê´€ë¦¬ì] íƒœê·¸ ìƒì„±             | ì•½ 600ms  |
| 6    | [ê´€ë¦¬ì] íƒœê·¸ ì „ì²´ ì¡°íšŒ        | ì•½ 500ms  |
| 7    | [ê´€ë¦¬ì] ê°œë°œì ëª¨ì„ ìƒì„±      | ì•½ 700ms  |
| 8    | [ê´€ë¦¬ì] ê°œë°œì ëª¨ì„ ì „ì²´ ì¡°íšŒ | ì•½ 500ms  |

<br /><br />

### 3-3. ì •ì  íŒŒì¼ ì œê³µ

ìŠ¤í† ë¦¬ì§€ëŠ” `ì˜¤ë¼í´ ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€` ë¡œ ê²°ì •ë˜ì—ˆìœ¼ë¯€ë¡œ, CDN ì„œë¹„ìŠ¤ë§Œ ë¹„êµí•˜ê² ìŠµë‹ˆë‹¤.

**ë¹„ìš© ì‚°ì • ê¸°ì¤€**ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

\< Dev-Event ì„œë¹„ìŠ¤ >

- íŠ¸ë˜í”½

  : ë¨¼ì € <a href="https://github.com/brave-people/Dev-Event/graphs/traffic">Dev-Event Github ì €ì¥ì†ŒÂ visitor</a> í†µê³„ ê·¼ê±°ë¡œ í•˜ë£¨ 120~220views ì´ë©°, ì›¹ìœ¼ë¡œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œ íŠ¸ë˜í”½ì„ ë„‰ë„‰ì¡ì•„ í•˜ë£¨ 300viewë¡œ ì‚°ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

  => 9000views/Month

- ì´ë¯¸ì§€ í¬ê¸°

  : `application.yml` ê¸°ì¤€ ì´ë¯¸ì§€ íŒŒì¼ í•˜ë‚˜ì˜ í¬ê¸°ëŠ” ìµœëŒ€ 3MBì´ë©°, í•œ í˜ì´ì§€ì—ì„œ 10ê°œì˜ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì£¼ë©°, ìµœì†Œ 2í˜ì´ì§€ ì´ìƒ ë°©ë¬¸ì´ë¼ê³  ê°€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

  => 60MB/1view

<br />

\< ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ >

- ë„¤íŠ¸ì›Œí¬ : **50GB**/ì›”
- HTTPSìš”ì²­ : 20000/ì›” *(í¬ì¼€ ì˜ë¯¸ ìˆëŠ” factorëŠ” ì•„ë‹™ë‹ˆë‹¤.)*

<br /> 

<br />

__ì„ íƒ1. AWS Cloud Front__

> ë¹„ìš©, ì¥ì 

| ë¹„ìš©                                                         | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ì¥ì              |
| ------------------------------------------------------------ | ----------- | ---------------- |
| ì•½ 7100ì›<br />(<a href="https://calculator.aws/#/createCalculator/CloudFront">AWS ê°€ê²©ì¸¡ì •ê¸°</a>) | O (ì™„ë£Œ)    | ì‚¬ìš© í¸ì˜ì„± ìš°ìˆ˜ |

cf) 1ë…„ ì‚¬ìš©ì— ëŒ€í•œ ì•½ì • ì‹œ CloudFront Savings Bundleì„ ì‚¬ìš©í•˜ì—¬ ìµœëŒ€ 30%ë¥¼ ì ˆê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.





<br />

__ì„ íƒ2. GCP Cloud CDN__

> ë¹„ìš©, ì¥ì 

| ë¹„ìš©                                                         | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ì¥ì  |
| ------------------------------------------------------------ | ----------- | ---- |
| ì•½ 5320ì›<br />(<a href="https://cloud.google.com/products/calculator#id=8e3dfe4e-bfb1-462d-9434-550f14c62465">GCP ê°€ê²©ì¸¡ì •ê¸°</a>) | X           |      |



<br />

__ì„ íƒ3. NCP CDN+__

> ë¹„ìš©, ì¥ì 

| ë¹„ìš©                                                         | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ì¥ì  |
| ------------------------------------------------------------ | ----------- | ---- |
| 4500ì›<br />(<a href="https://www.ncloud.com/charge/calc/ko?category=networking#cdn">NCP ê°€ê²©ì¸¡ì •ê¸°</a>) | X           |      |



<br />

__ì„ íƒ4. NHN CDN__

> ë¹„ìš©, ì¥ì 

| ë¹„ìš©                                                         | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ì¥ì  |
| ------------------------------------------------------------ | ----------- | ---- |
| 5000ì›<br />(<a href="https://www.toast.com/kr/service/content_delivery/cdn">NHN ê°€ê²©</a>) | X           |      |



<br />

__ì„ íƒ5. ê°€ë¹„ì•„ ë¡œì»¬ CDN__

> ë¹„ìš©, ì¥ì 

| ë¹„ìš©                                                         | ì‹¤ì œ í…ŒìŠ¤íŠ¸ | ì¥ì  |
| ------------------------------------------------------------ | ----------- | ---- |
| 3500ì›<br />(<a href="https://cloud.gabia.com/cdn">gabiaê°€ê²©</a>) | X           |      |

cf) ë¡œì»¬ CDNì€ í•´ì™¸ íŠ¸ë˜í”½ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.



<br />

<br />

=> ì§ì ‘ ì‚¬ìš© ì „ì— ë¹„êµí–ˆì„ ì‹œì—ëŠ” ë¹„ìš©ì ì¸ ë¶€ë¶„ì„ ì œì™¸í•˜ê³ ëŠ” í° ì°¨ì´ê°€ ì—†ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

